package org.kuali.kra;

import com.thoughtworks.selenium.*;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import java.util.regex.Pattern;

public class ProtocolProtocolPageTest extends KcSeleniumTestBase {
	@Before
	public void setUp() throws Exception {
		selenium = new DefaultSelenium("localhost", 4444, "*firefox", "http://127.0.0.1:8080/kc-dev/portal.do");
		selenium.start();
	}

	@Test
	public void testProtocolProtocolPage() throws Exception {
		selenium.open("/kc-dev/portal.do");
		selenium.click("link=Create Protocol");
		selenium.waitForPageToLoad("30000");
		selenium.selectFrame("iframeportlet");
		selenium.type("//input[@id='document.documentHeader.documentDescription']", "test");
		selenium.type("//textarea[@id='document.protocolList[0].title']", "test");
		selenium.click("methodToCall.performLookup.(!!org.kuali.kra.bo.KcPerson!!).(((personId:protocolHelper.personId,fullName:protocolHelper.principalInvestigatorName,unit.unitNumber:protocolHelper.lookupUnitNumber,unit.unitName:protocolHelper.lookupUnitName))).((``)).((<>)).(([])).((**)).((^^)).((&&)).((//)).((~~)).(::::;;::::).anchor");
		selenium.waitForPageToLoad("30000");
		selenium.click("//input[@name='methodToCall.search' and @value='search']");
		selenium.waitForPageToLoad("30000");
		selenium.click("//table[@id='row']/tbody/tr[3]/td[1]/a");
		selenium.waitForPageToLoad("30000");
		selenium.click("tab-AdditionalInformation-imageToggle");
		selenium.click("methodToCall.performLookup.(!!org.kuali.kra.bo.ResearchArea!!).((``)).(:;protocolResearchAreas;:).((%true%)).((~~)).anchorAdditionalInformation");
		selenium.waitForPageToLoad("30000");
		selenium.click("//input[@name='methodToCall.search' and @value='search']");
		selenium.waitForPageToLoad("30000");
		selenium.click("selectedObjId-5D3A0F0446DDD6C5E0404F8189D82652");
		selenium.click("methodToCall.prepareToReturnSelectedResults.(::;false;::)");
		selenium.waitForPageToLoad("30000");
		selenium.type("//input[@id='document.protocolList[0].fdaApplicationNumber']", "fdaide");
		selenium.type("//input[@id='document.protocolList[0].referenceNumber2']", "id2");
		selenium.type("//input[@id='document.protocolList[0].referenceNumber1']", "id1");
		selenium.type("//textarea[@id='document.protocolList[0].description']", "summary keyword");
		selenium.select("newProtocolReferenceBean.protocolReferenceTypeCode", "label=CALGB");
		selenium.type("newProtocolReferenceBean.referenceKey", "oid1");
		selenium.type("newProtocolReferenceBean.applicationDate", "01/01/2011");
		selenium.type("newProtocolReferenceBean.approvalDate", "01/31/2011");
		selenium.type("newProtocolReferenceBean.comments", "other identifier");
		selenium.click("methodToCall.addProtocolReferenceBean.anchorAdditionalInformation");
		selenium.waitForPageToLoad("30000");
		selenium.click("tab-Organizations-imageToggle");
		selenium.click("methodToCall.performLookup.(!!org.kuali.kra.bo.Organization!!).(((organizationId:protocolHelper.newProtocolLocation.organizationId,contactAddressId:protocolHelper.newProtocolLocation.rolodexId,humanSubAssurance:protocolHelper.newProtocolLocation.organization.humanSubAssurance,organizationName:protocolHelper.newProtocolLocation.organization.organizationName,rolodex.firstName:protocolHelper.newProtocolLocation.organization.rolodex.firstName,rolodex.lastName:protocolHelper.newProtocolLocation.organization.rolodex.lastName,rolodex.addressLine1:protocolHelper.newProtocolLocation.organization.rolodex.addressLine1,rolodex.addressLine2:protocolHelper.newProtocolLocation.organization.rolodex.addressLine2,rolodex.addressLine3:protocolHelper.newProtocolLocation.organization.rolodex.addressLine3,rolodex.city:protocolHelper.newProtocolLocation.organization.rolodex.city,rolodex.state:protocolHelper.newProtocolLocation.organization.rolodex.state))).((``)).((<>)).(([])).((**)).((^^)).((&&)).((//)).((~~)).(::::;;::::).anchor24");
		selenium.waitForPageToLoad("30000");
		selenium.click("//input[@name='methodToCall.search' and @value='search']");
		selenium.waitForPageToLoad("30000");
		selenium.click("link=return value");
		selenium.waitForPageToLoad("30000");
		selenium.select("protocolHelper.newProtocolLocation.protocolOrganizationTypeCode", "label=Performing Organization");
		selenium.click("methodToCall.addProtocolLocation.anchorOrganizations");
		selenium.waitForPageToLoad("30000");
		selenium.click("tab-FundingSources-imageToggle");
		selenium.select("protocolHelper.newFundingSource.fundingSourceTypeCode", "label=Unit");
		selenium.click("//select[@id='protocolHelper.newFundingSource.fundingSourceTypeCode']/option[3]");
		selenium.click("methodToCall.performFundingSourceLookup.(!!!!).((())).((``)).((<>)).(([])).((**)).((^^)).((&&)).((//)).((~~)).anchor35");
		selenium.waitForPageToLoad("30000");
		selenium.click("//input[@name='methodToCall.search' and @value='search']");
		selenium.waitForPageToLoad("30000");
		selenium.click("//table[@id='row']/tbody/tr[2]/td[1]/a");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.addProtocolFundingSource.anchorFundingSources");
		selenium.waitForPageToLoad("30000");
		selenium.click("tab-ParticipantTypes-imageToggle");
		selenium.select("protocolHelper.newProtocolParticipant.participantTypeCode", "label=Children");
		selenium.type("protocolHelper.newProtocolParticipant.participantCount", "1");
		selenium.click("methodToCall.addProtocolParticipant.anchorParticipantTypes");
		selenium.waitForPageToLoad("30000");
		selenium.select("protocolHelper.newProtocolParticipant.participantTypeCode", "label=Other");
		selenium.type("protocolHelper.newProtocolParticipant.participantCount", "2");
		selenium.click("methodToCall.addProtocolParticipant.anchorParticipantTypes");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.save");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.deleteProtocolResearchArea.line1.anchor10");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.deleteProtocolLocation.line1.anchor24");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.deleteProtocolFundingSource.line0.anchor31");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.processAnswer.button0");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.deleteProtocolParticipant.line1.anchor35.validate0");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.save");
		selenium.waitForPageToLoad("30000");
		verifyEquals("999", selenium.getValue("//input[@id='document.protocolList[0].protocolParticipants[1].participantCount']"));
	}

	@After
	public void tearDown() throws Exception {
		selenium.stop();
	}
}
