package org.kuali.kra;

import com.thoughtworks.selenium.*;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import java.util.regex.Pattern;

public class ProtocolSubmitTest extends KcSeleniumTestBase {
	@Before
	public void setUp() throws Exception {
		selenium = new DefaultSelenium("localhost", 4444, "*firefox", "http://127.0.0.1:8080/");
		selenium.start();
	}

	@Test
	public void testProtocolSubmit() throws Exception {
		selenium.open("/kc-dev/portal.do?channelTitle=Document%20Search&channelUrl=http://127.0.0.1:8080/kc-dev/kew/DocumentSearch.do?docFormKey=88888888&returnLocation=http://127.0.0.1:8080/kc-dev/portal.do&hideReturnLink=true");
		selenium.click("link=Researcher");
		selenium.waitForPageToLoad("30000");
		selenium.click("link=Create Protocol");
		selenium.waitForPageToLoad("30000");
		selenium.selectFrame("iframeportlet");
		selenium.type("//input[@id='document.documentHeader.documentDescription']", "test");
		selenium.type("//textarea[@id='document.protocolList[0].title']", "test");
		selenium.click("methodToCall.performLookup.(!!org.kuali.kra.bo.KcPerson!!).(((personId:protocolHelper.personId,fullName:protocolHelper.principalInvestigatorName,unit.unitNumber:protocolHelper.lookupUnitNumber,unit.unitName:protocolHelper.lookupUnitName))).((``)).((<>)).(([])).((**)).((^^)).((&&)).((//)).((~~)).(::::;;::::).anchor");
		selenium.waitForPageToLoad("30000");
		selenium.click("//input[@name='methodToCall.search' and @value='search']");
		selenium.waitForPageToLoad("30000");
		selenium.click("//table[@id='row']/tbody/tr[3]/td[1]/a");
		selenium.waitForPageToLoad("30000");
		selenium.click("methodToCall.headerTab.headerDispatch.save.navigateTo.protocolActions");
		selenium.waitForPageToLoad("30000");
		selenium.click("tab-RequestanAction-imageToggle");
		selenium.click("tab-:SubmitforReview-imageToggle");
		selenium.select("actionHelper.protocolSubmitAction.submissionTypeCode", "label=Initial Protocol Application for Approval");
		selenium.select("actionHelper.protocolSubmitAction.protocolReviewTypeCode", "label=Full");
		selenium.select("actionHelper.protocolSubmitAction.committeeId", "label=test");
		selenium.select("actionHelper.protocolSubmitAction.scheduleId", "label=02-06-2012, [no location], 12:00 PM");
		selenium.select("actionHelper.protocolSubmitAction.scheduleId", "label=01-06-2012, [no location], 12:00 PM");
		selenium.select("actionHelper.protocolSubmitAction.committeeId", "label=cpmm name");
		selenium.click("//option[@value='comm11']");
		selenium.select("actionHelper.protocolSubmitAction.scheduleId", "label=03-06-2011, [no location], 12:00 PM");
		selenium.select("actionHelper.protocolSubmitAction.reviewer[0].reviewerTypeCode", "label=primary");
		selenium.select("actionHelper.protocolSubmitAction.protocolReviewTypeCode", "label=Expedited");
		selenium.select("actionHelper.protocolSubmitAction.protocolReviewTypeCode", "label=Exempt");
		selenium.select("actionHelper.protocolSubmitAction.protocolReviewTypeCode", "label=Expedited");
		selenium.select("actionHelper.protocolSubmitAction.protocolReviewTypeCode", "label=Exempt");
		selenium.select("actionHelper.protocolSubmitAction.protocolReviewTypeCode", "label=Expedited");
		selenium.click("actionHelper.protocolSubmitAction.expeditedReviewCheckList[0].checked");
		selenium.click("methodToCall.submitForReview.anchor:SubmitforReview");
		selenium.waitForPageToLoad("30000");
	}

	@After
	public void tearDown() throws Exception {
		selenium.stop();
	}
}
