-- View for Coeus compatibility 
CREATE OR REPLACE VIEW OSP$COMM_MEMBERSHIPS AS

SELECT
    CM.COMMITTEE_ID,
    CM.PERSON_ID,
    CM.MEMBERSHIP_ID,
    CM.SEQUENCE_NUMBER,
    RD.LAST_NAME || ', ' || RD.FIRST_NAME || ' ' || RD.MIDDLE_NAME AS PERSON_NAME,
    CM.NON_EMPLOYEE_FLAG,
    CM.PAID_MEMBER_FLAG,
    CM.TERM_START_DATE,
    CM.TERM_END_DATE,
    CM.MEMBERSHIP_TYPE_CODE,
    CM.COMMENTS,
    CM.UPDATE_TIMESTAMP,
    CM.UPDATE_USER
FROM COMM_MEMBERSHIPS CM,
     ROLODEX RD
WHERE CM.PERSON_ID = RD.ROLODEX_ID
  AND CM.NON_EMPLOYEE_FLAG = 'Y'

UNION ALL

SELECT
    CM.COMMITTEE_ID,
    CM.PERSON_ID,
    CM.MEMBERSHIP_ID,
    CM.SEQUENCE_NUMBER,
    PS.LAST_NAME || ', ' || PS.FIRST_NAME || ' ' || PS.MIDDLE_NAME AS PERSON_NAME,
    CM.NON_EMPLOYEE_FLAG,
    CM.PAID_MEMBER_FLAG,
    CM.TERM_START_DATE,
    CM.TERM_END_DATE,
    CM.MEMBERSHIP_TYPE_CODE,
    CM.COMMENTS,
    CM.UPDATE_TIMESTAMP,
    CM.UPDATE_USER
FROM COMM_MEMBERSHIPS CM,
     PERSON PS
WHERE CM.PERSON_ID = PS.PERSON_ID
  AND CM.NON_EMPLOYEE_FLAG = 'N'

;