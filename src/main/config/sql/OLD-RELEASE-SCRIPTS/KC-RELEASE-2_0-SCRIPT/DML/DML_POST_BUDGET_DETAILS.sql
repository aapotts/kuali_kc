INSERT INTO BUDGET (BUDGET_ID, BUDGET_JUSTIFICATION, ON_OFF_CAMPUS_FLAG, PROPOSAL_NUMBER, VERSION_NUMBER, DOCUMENT_NUMBER, START_DATE, END_DATE, TOTAL_COST, TOTAL_DIRECT_COST, TOTAL_INDIRECT_COST, COST_SHARING_AMOUNT, UNDERRECOVERY_AMOUNT, RESIDUAL_FUNDS, TOTAL_COST_LIMIT, OH_RATE_CLASS_CODE, OH_RATE_TYPE_CODE, COMMENTS, FINAL_VERSION_FLAG, UPDATE_TIMESTAMP, UPDATE_USER, UR_RATE_CLASS_CODE, MODULAR_BUDGET_FLAG, VER_NBR, OBJ_ID) 
SELECT SEQ_BUDGET_ID.NEXTVAL,
	   T.BUDGET_JUSTIFICATION,
       T.ON_OFF_CAMPUS_FLAG,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.DOCUMENT_NUMBER,
       T.START_DATE,
       T.END_DATE,
       T.TOTAL_COST,
       T.TOTAL_DIRECT_COST,
       T.TOTAL_INDIRECT_COST,
       T.COST_SHARING_AMOUNT,
       T.UNDERRECOVERY_AMOUNT,
       T.RESIDUAL_FUNDS,
       T.TOTAL_COST_LIMIT,
       T.OH_RATE_CLASS_CODE,
       T.OH_RATE_TYPE_CODE,
       T.COMMENTS,
       T.FINAL_VERSION_FLAG,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.UR_RATE_CLASS_CODE,
       T.MODULAR_BUDGET_FLAG,
       T.VER_NBR,
       T.OBJ_ID
FROM   TEMP_B T;

DROP TABLE TEMP_B;

INSERT INTO BUDGET_DETAILS (BUDGET_PERIOD_NUMBER, GROUP_NAME, BUDGET_ID, PROPOSAL_NUMBER, VERSION_NUMBER, BUDGET_PERIOD, LINE_ITEM_NUMBER, BUDGET_CATEGORY_CODE, 
  COST_ELEMENT, LINE_ITEM_DESCRIPTION, BASED_ON_LINE_ITEM, LINE_ITEM_SEQUENCE, START_DATE, END_DATE, LINE_ITEM_COST, COST_SHARING_AMOUNT, UNDERRECOVERY_AMOUNT, 
  ON_OFF_CAMPUS_FLAG, APPLY_IN_RATE_FLAG, BUDGET_JUSTIFICATION, UPDATE_TIMESTAMP, UPDATE_USER, QUANTITY, VER_NBR, BUDGET_DETAILS_ID, OBJ_ID)
SELECT T.BUDGET_PERIOD_NUMBER,
       T.GROUP_NAME,
       B.BUDGET_ID,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.BUDGET_PERIOD,
       T.LINE_ITEM_NUMBER,
       T.BUDGET_CATEGORY_CODE,
       T.COST_ELEMENT,
       T.LINE_ITEM_DESCRIPTION,
       T.BASED_ON_LINE_ITEM,
       T.LINE_ITEM_SEQUENCE,
       T.START_DATE,
       T.END_DATE,
       T.LINE_ITEM_COST,
       T.COST_SHARING_AMOUNT,
       T.UNDERRECOVERY_AMOUNT,
       T.ON_OFF_CAMPUS_FLAG,
       T.APPLY_IN_RATE_FLAG,
       T.BUDGET_JUSTIFICATION,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.QUANTITY,
       T.VER_NBR,
       SEQ_BUDGET_DETAILS_ID.NEXTVAL,
       T.OBJ_ID
FROM   TEMP_BD T, BUDGET B
WHERE T.PROPOSAL_NUMBER = B.PROPOSAL_NUMBER 
  AND T.VERSION_NUMBER = B.VERSION_NUMBER;

DROP TABLE TEMP_BD;

INSERT INTO BUDGET_DETAILS_CAL_AMTS (BUDGET_ID, BUDGET_PERIOD_NUMBER, PROPOSAL_NUMBER, VERSION_NUMBER, BUDGET_PERIOD, LINE_ITEM_NUMBER, RATE_CLASS_CODE, 
  RATE_TYPE_CODE, APPLY_RATE_FLAG, CALCULATED_COST, CALCULATED_COST_SHARING, UPDATE_TIMESTAMP, UPDATE_USER, VER_NBR, BUDGET_DETAILS_CAL_AMTS_ID, BUDGET_DETAILS_ID, 
  OBJ_ID)
SELECT B.BUDGET_ID
       T.BUDGET_PERIOD_NUMBER,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.BUDGET_PERIOD,
       T.LINE_ITEM_NUMBER,
       T.RATE_CLASS_CODE,
       T.RATE_TYPE_CODE,
       T.APPLY_RATE_FLAG,
       T.CALCULATED_COST,
       T.CALCULATED_COST_SHARING,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.VER_NBR,
       SEQ_BUDGET_DETAILS_CAL_AMTS_ID.NEXTVAL,
       BD.BUDGET_DETAILS_ID,
       T.OBJ_ID
FROM   TEMP_BDCA T, BUDGET B, BUDGET_DETAILS BD
WHERE T.PROPOSAL_NUMBER = B.PROPOSAL_NUMBER 
  AND T.VERSION_NUMBER = B.VERSION_NUMBER
  AND B.BUDGET_ID = BD.BUDGET_ID
  AND T.BUDGET_PERIOD = BD.BUDGET_PERIOD
  AND T.LINE_ITEM_NUMBER = BD.LINE_ITEM_NUMBER;

DROP TABLE TEMP_BDCA;

INSERT INTO BUDGET_RATE_AND_BASE (BUDGET_PERIOD_NUMBER, BUDGET_ID, PROPOSAL_NUMBER, VERSION_NUMBER, BUDGET_PERIOD, LINE_ITEM_NUMBER, RATE_NUMBER, START_DATE, END_DATE, 
RATE_CLASS_CODE, RATE_TYPE_CODE, ON_OFF_CAMPUS_FLAG, APPLIED_RATE, BASE_COST, BASE_COST_SHARING, CALCULATED_COST, CALCULATED_COST_SHARING, UPDATE_TIMESTAMP, UPDATE_USER, 
VER_NBR, BUDGET_RATE_AND_BASE_ID, BUDGET_DETAILS_CAL_AMTS_ID, BUDGET_DETAILS_ID, OBJ_ID)
SELECT T.BUDGET_PERIOD_NUMBER,
       BDCA.BUDGET_ID,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.BUDGET_PERIOD,
       T.LINE_ITEM_NUMBER,
       T.RATE_NUMBER,
       T.START_DATE,
       T.END_DATE,
       T.RATE_CLASS_CODE,
       T.RATE_TYPE_CODE,
       T.ON_OFF_CAMPUS_FLAG,
       T.APPLIED_RATE,
       T.BASE_COST,
       T.BASE_COST_SHARING,
       T.CALCULATED_COST,
       T.CALCULATED_COST_SHARING,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.VER_NBR,
       SEQ_BUDGET_RATE_AND_BASE_ID.NEXTVAL,
       BDCA.BUDGET_DETAILS_CAL_AMTS_ID,
       BDCA.BUDGET_DETAILS_ID,
       T.OBJ_ID
FROM   TEMP_BRAB T, BUDGET_DETAILS_CAL_AMTS BDCA
WHERE T.PROPOSAL_NUMBER = BDCA.PROPOSAL_NUMBER
  AND T.VERSION_NUMBER = BDCA.VERSION_NUMBER
  AND T.BUDGET_PERIOD = BDCA.BUDGET_PERIOD
  AND T.LINE_ITEM_NUMBER = BDCA.LINE_ITEM_NUMBER
  AND T.RATE_CLASS_CODE = BDCA.RATE_CLASS_CODE
  AND T.RATE_TYPE_CODE = BDCA.RATE_TYPE_CODE;

DROP TABLE TEMP_BRAB;

INSERT INTO BUDGET_PERSONNEL_DETAILS (PERSON_SEQUENCE_NUMBER, BUDGET_PERIOD_NUMBER, BUDGET_ID, LINE_ITEM_NUMBER, PERSON_NUMBER, PERSON_ID, JOB_CODE, START_DATE, END_DATE, 
  PERIOD_TYPE, LINE_ITEM_DESCRIPTION, SEQUENCE_NUMBER, SALARY_REQUESTED, PERCENT_CHARGED, PERCENT_EFFORT, COST_SHARING_PERCENT, COST_SHARING_AMOUNT, UNDERRECOVERY_AMOUNT, 
  ON_OFF_CAMPUS_FLAG, APPLY_IN_RATE_FLAG, BUDGET_JUSTIFICATION, UPDATE_TIMESTAMP, UPDATE_USER, VER_NBR, PROPOSAL_NUMBER, VERSION_NUMBER, BUDGET_PERIOD, 
  BUDGET_PERSONNEL_DETAILS_ID, BUDGET_DETAILS_ID, OBJ_ID)
SELECT T.PERSON_SEQUENCE_NUMBER,
       T.BUDGET_PERIOD_NUMBER,
       BD.BUDGET_ID,
       T.LINE_ITEM_NUMBER,
       T.PERSON_NUMBER,
       T.PERSON_ID,
       T.JOB_CODE,
       T.START_DATE,
       T.END_DATE,
       T.PERIOD_TYPE,
       T.LINE_ITEM_DESCRIPTION,
       T.SEQUENCE_NUMBER,
       T.SALARY_REQUESTED,
       T.PERCENT_CHARGED,
       T.PERCENT_EFFORT,
       T.COST_SHARING_PERCENT,
       T.COST_SHARING_AMOUNT,
       T.UNDERRECOVERY_AMOUNT,
       T.ON_OFF_CAMPUS_FLAG,
       T.APPLY_IN_RATE_FLAG,
       T.BUDGET_JUSTIFICATION,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.VER_NBR,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.BUDGET_PERIOD,
       SEQ_BUDGET_PER_DET_ID.NEXTVAL,
       BD.BUDGET_DETAILS_ID,
       T.OBJ_ID
FROM   TEMP_BPD T, BUDGET_DETAILS BD
WHERE T.PROPOSAL_NUMBER = BD.PROPOSAL_NUMBER
  AND T.VERSION_NUMBER = BD.VERSION_NUMBER
  AND T.BUDGET_PERIOD = BD.BUDGET_PERIOD
  AND T.LINE_ITEM_NUMBER = BD.LINE_ITEM_NUMBER;

DROP TABLE TEMP_BPD;

INSERT INTO BUDGET_PERSONNEL_CAL_AMTS (BUDGET_PERIOD_NUMBER, BUDGET_ID, PROPOSAL_NUMBER, VERSION_NUMBER, BUDGET_PERIOD, LINE_ITEM_NUMBER, PERSON_NUMBER, 
RATE_CLASS_CODE, RATE_TYPE_CODE, APPLY_RATE_FLAG, CALCULATED_COST, CALCULATED_COST_SHARING, UPDATE_TIMESTAMP, UPDATE_USER, VER_NBR, BUDGET_PERSONNEL_CAL_AMTS_ID, 
BUDGET_PERSONNEL_DETAILS_ID, OBJ_ID)
SELECT T.BUDGET_PERIOD_NUMBER,
       BPD.BUDGET_ID,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.BUDGET_PERIOD,
       T.LINE_ITEM_NUMBER,
       T.PERSON_NUMBER,
       T.RATE_CLASS_CODE,
       T.RATE_TYPE_CODE,
       T.APPLY_RATE_FLAG,
       T.CALCULATED_COST,
       T.CALCULATED_COST_SHARING,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.VER_NBR,
       SEQ_BUDGET_PER_CAL_AMTS_ID.NEXTVAL,
       BPD.BUDGET_PERSONNEL_DETAILS_ID,
       T.OBJ_ID
FROM   TEMP_BPCA T, BUDGET_PERSONNEL_DETAILS BPD
WHERE T.PROPOSAL_NUMBER = BPD.PROPOSAL_NUMBER
  AND T.VERSION_NUMBER = BPD.VERSION_NUMBER
  AND T.BUDGET_PERIOD = BPD.BUDGET_PERIOD
  AND T.LINE_ITEM_NUMBER = BPD.LINE_ITEM_NUMBER
  AND T.PERSON_NUMBER = BPD.PERSON_NUMBER;

DROP TABLE TEMP_BPCA;

INSERT INTO BUDGET_PER_DET_RATE_AND_BASE (BUDGET_ID, PROPOSAL_NUMBER, VERSION_NUMBER, BUDGET_PERIOD, LINE_ITEM_NUMBER, PERSON_NUMBER, RATE_NUMBER, PERSON_ID, START_DATE, 
  END_DATE, RATE_CLASS_CODE, RATE_TYPE_CODE, ON_OFF_CAMPUS_FLAG, APPLIED_RATE, SALARY_REQUESTED, BASE_COST_SHARING, CALCULATED_COST, CALCULATED_COST_SHARING, 
  UPDATE_TIMESTAMP, UPDATE_USER, VER_NBR, UNDERRECOVERY_AMOUNT, BUDGET_PERIOD_NUMBER, BGT_PER_DET_RATE_AND_BASE_ID, BUDGET_PERSONNEL_DETAILS_ID, 
  BUDGET_PERSONNEL_CAL_AMTS_ID, OBJ_ID)
SELECT BPCA.BUDGET_ID,
       T.PROPOSAL_NUMBER,
       T.VERSION_NUMBER,
       T.BUDGET_PERIOD,
       T.LINE_ITEM_NUMBER,
       T.PERSON_NUMBER,
       T.RATE_NUMBER,
       T.PERSON_ID,
       T.START_DATE,
       T.END_DATE,
       T.RATE_CLASS_CODE,
       T.RATE_TYPE_CODE,
       T.ON_OFF_CAMPUS_FLAG,
       T.APPLIED_RATE,
       T.SALARY_REQUESTED,
       T.BASE_COST_SHARING,
       T.CALCULATED_COST,
       T.CALCULATED_COST_SHARING,
       T.UPDATE_TIMESTAMP,
       T.UPDATE_USER,
       T.VER_NBR,
       T.UNDERRECOVERY_AMOUNT,
       T.BUDGET_PERIOD_NUMBER,
       SEQ_BGT_PER_DET_RATE_BASE_ID.NEXTVAL,
       BPCA.BUDGET_PERSONNEL_DETAILS_ID,
       BPCA.BUDGET_PERSONNEL_CAL_AMTS_ID,
       T.OBJ_ID
FROM   TEMP_BPDRAB T, BUDGET_PERSONNEL_CAL_AMTS BPCA
WHERE T.PROPOSAL_NUMBER = BPCA.PROPOSAL_NUMBER
  AND T.VERSION_NUMBER = BPCA.VERSION_NUMBER
  AND T.BUDGET_PERIOD = BPCA.BUDGET_PERIOD
  AND T.LINE_ITEM_NUMBER = BPCA.LINE_ITEM_NUMBER
  AND T.PERSON_NUMBER = BPCA.PERSON_NUMBER
  AND T.RATE_CLASS_CODE = BPCA.RATE_CLASS_CODE
  AND T.RATE_TYPE_CODE = BPCA.RATE_TYPE_CODE;

DROP TABLE TEMP_BPDRAB

