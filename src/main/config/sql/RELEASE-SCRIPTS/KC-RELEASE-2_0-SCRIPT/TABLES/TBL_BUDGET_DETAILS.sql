ALTER TABLE BUDGET_DETAILS DROP PRIMARY KEY CASCADE;

ALTER TABLE BUDGET_DETAILS MODIFY PROPOSAL_NUMBER NULL;

ALTER TABLE BUDGET_DETAILS MODIFY VERSION_NUMBER NULL;

ALTER TABLE BUDGET_DETAILS 
	ADD (HIERARCHY_PROPOSAL_NUMBER VARCHAR (12) , 
		HIDE_IN_HIERARCHY CHAR (1) DEFAULT 'N' NOT NULL,
		BUDGET_DETAILS_ID NUMBER (12,0) ,
		BUDGET_ID NUMBER (12, 0) ) ;

UPDATE BUDGET_DETAILS 
SET BUDGET_ID=(SELECT BUDGET_ID FROM BUDGET 
               WHERE BUDGET.PROPOSAL_NUMBER = BUDGET_DETAILS.PROPOSAL_NUMBER
                     AND BUDGET.VERSION_NUMBER = BUDGET_DETAILS.VERSION_NUMBER) ;

COMMIT;

ALTER TABLE BUDGET_DETAILS 
    ADD CONSTRAINT BUDGET_DETAILS_PK 
            PRIMARY KEY (BUDGET_DETAILS_ID) ;
