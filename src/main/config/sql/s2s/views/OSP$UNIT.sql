
CREATE OR REPLACE VIEW OSP$UNIT   ( 
UNIT_NUMBER, UNIT_NAME, ADMINISTRATIVE_OFFICER, OSP_ADMINISTRATOR, UNIT_HEAD, DEAN_VP, 
OTHER_INDIVIDUAL_TO_NOTIFY, ORGANIZATION_ID, UPDATE_TIMESTAMP, UPDATE_USER 
)
AS select  
	   U.UNIT_NUMBER, U.UNIT_NAME, 
	   decode(ua.UNIT_ADMINISTRATOR_TYPE_CODE,1,person_id) as ADMINISTRATIVE_OFFICER, 
	   decode(ua.UNIT_ADMINISTRATOR_TYPE_CODE,2,person_id) as OSP_ADMINISTRATOR, 
	   decode(ua.UNIT_ADMINISTRATOR_TYPE_CODE,3,person_id) as UNIT_HEAD, 
	   decode(ua.UNIT_ADMINISTRATOR_TYPE_CODE,4,person_id) as DEAN_VP, 
	   decode(ua.UNIT_ADMINISTRATOR_TYPE_CODE,5,person_id) as OTHER_INDIVIDUAL_TO_NOTIFY, 
	   ORGANIZATION_ID, UPDATE_TIMESTAMP, UPDATE_USER
	from UNIT U,
	(select unit_number,person_id,UNIT_ADMINISTRATOR_TYPE_CODE 
			from unit_administrator where UNIT_ADMINISTRATOR_TYPE_CODE in ( 1,2,3,4,5)) ua
	where U.UNIT_NUMBER = ua.UNIT_NUMBER(+);
	
	